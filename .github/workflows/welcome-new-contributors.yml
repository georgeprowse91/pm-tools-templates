name: Welcome New Contributors

# Trigger when new issues or PRs are opened
on:
  issues:
    types: [opened]
  pull_request_target:
    types: [opened]

jobs:
  welcome:
    name: Welcome Message
    runs-on: ubuntu-latest
    
    steps:
    - name: Welcome new issue creators
      if: github.event_name == 'issues'
      uses: actions/github-script@v7
      with:
        script: |
          const issue = context.payload.issue;
          const author = issue.user.login;
          
          // Check if this is the user's first issue in this repository
          const { data: issues } = await github.rest.issues.listForRepo({
            owner: context.repo.owner,
            repo: context.repo.repo,
            creator: author,
            state: 'all'
          });
          
          if (issues.length === 1) {
            const welcomeMessage = `ðŸ‘‹ Welcome to the PM Tools & Templates community, @${author}!
            
ðŸŽ‰ **Thank you for opening your first issue!** We're excited to have you contribute to making project management better for everyone.

ðŸ“‹ **What happens next:**
- Our team will review your issue within 2-3 business days
- If you're reporting a bug, we may ask for additional details
- If you're suggesting an enhancement, we'll discuss the best approach

ðŸš€ **Want to contribute more?**
- Check out our [Contributing Guide](https://github.com/mirichard/pm-tools-templates/blob/main/CONTRIBUTING.md)
- Browse our [Good First Issues](https://github.com/mirichard/pm-tools-templates/labels/good%20first%20issue)
- Join our [Discussions](https://github.com/mirichard/pm-tools-templates/discussions) for community chat

ðŸ’¡ **Pro tip:** If you're interested in contributing templates, we'd love to see examples from your real project experience!

Thanks for helping make this the best PM template library! ðŸŒŸ`;
            
            await github.rest.issues.createComment({
              owner: context.repo.owner,
              repo: context.repo.repo,
              issue_number: issue.number,
              body: welcomeMessage
            });
          }
    
    - name: Welcome new pull request creators
      if: github.event_name == 'pull_request_target'
      uses: actions/github-script@v7
      with:
        script: |
          const pr = context.payload.pull_request;
          const author = pr.user.login;
          
          // Check if this is the user's first PR in this repository
          const { data: prs } = await github.rest.pulls.list({
            owner: context.repo.owner,
            repo: context.repo.repo,
            creator: author,
            state: 'all'
          });
          
          if (prs.length === 1) {
            const welcomeMessage = `ðŸŽ‰ Welcome to the PM Tools & Templates community, @${author}!
            
ðŸš€ **Thank you for your first pull request!** This is awesome - you're helping thousands of project managers worldwide!

ðŸ“‹ **What happens next:**
- Our automated quality checks will run (you can see them above)
- A maintainer will review your contribution within 5-7 days
- We may suggest improvements or ask questions
- Once approved, your contribution becomes part of the library!

âœ… **Review checklist** (for your reference):
- [ ] New templates include clear usage instructions
- [ ] All example data uses placeholders (no real/sensitive information)
- [ ] Templates have been tested in their target software
- [ ] Documentation follows our style guide

ðŸŒŸ **Recognition:**
- Contributors are listed in our [Contributors page](https://github.com/mirichard/pm-tools-templates/graphs/contributors)
- Quality contributions earn community recognition
- Regular contributors may be invited to join our review team

ðŸ“š **Resources:**
- [Contributing Guide](https://github.com/mirichard/pm-tools-templates/blob/main/CONTRIBUTING.md)
- [Code of Conduct](https://github.com/mirichard/pm-tools-templates/blob/main/CODE_OF_CONDUCT.md)
- [Community Discussions](https://github.com/mirichard/pm-tools-templates/discussions)

Thank you for making project management better for everyone! ðŸ™Œ`;
            
            await github.rest.issues.createComment({
              owner: context.repo.owner,
              repo: context.repo.repo,
              issue_number: pr.number,
              body: welcomeMessage
            });
          }

