name: ğŸ§ª Simple Template Validation

on:
  workflow_dispatch:
    inputs:
      validation_scope:
        description: 'Validation scope'
        required: false
        default: 'templates-only'
        type: choice
        options:
          - templates-only
          - comprehensive

permissions:
  contents: read
  pull-requests: write

jobs:
  simple-validation:
    name: ğŸ“‹ Simple Template Check
    runs-on: ubuntu-latest
    
    steps:
      - name: ğŸ“¥ Checkout Repository
        uses: actions/checkout@v4

      - name: ğŸ” Find Templates
        run: |
          echo "ğŸ” Finding template files..."
          
          # Find all markdown templates
          templates=$(find templates -name "*.md" 2>/dev/null || echo "No templates directory found")
          
          if [ "$templates" != "No templates directory found" ]; then
            echo "ğŸ“„ Found templates:"
            echo "$templates"
            
            template_count=$(echo "$templates" | wc -l)
            echo "Total templates: $template_count"
          else
            echo "âŒ No templates directory found"
            exit 1
          fi

      - name: ğŸ“ Basic Validation
        run: |
          echo "ğŸ“ Running basic validation..."
          
          # Check each template
          for template in $(find templates -name "*.md" 2>/dev/null); do
            echo "Checking: $template"
            
            # Check if file has frontmatter
            if head -1 "$template" | grep -q "^---$"; then
              echo "  âœ… Has frontmatter"
            else
              echo "  âš ï¸  No frontmatter detected"
            fi
            
            # Check file size
            size=$(wc -c < "$template")
            if [ "$size" -gt 100 ]; then
              echo "  âœ… Adequate content ($size bytes)"
            else
              echo "  âš ï¸  Very short content ($size bytes)"
            fi
            
            # Check for placeholder content
            if grep -q "TODO\|FIXME\|XXX" "$template"; then
              echo "  âš ï¸  Contains TODO markers"
            else
              echo "  âœ… No TODO markers"
            fi
            
            echo ""
          done

      - name: ğŸ“Š Generate Report
        run: |
          echo "ğŸ“Š Generating validation report..."
          
          # Create simple report
          cat > validation-report.md << 'EOF'
          # Simple Template Validation Report
          
          **Generated:** $(date -u +"%Y-%m-%d %H:%M:%S UTC")
          **Scope:** ${{ github.event.inputs.validation_scope }}
          
          ## Summary
          
          EOF
          
          template_count=$(find templates -name "*.md" 2>/dev/null | wc -l)
          echo "- Templates found: $template_count" >> validation-report.md
          echo "- Validation scope: ${{ github.event.inputs.validation_scope }}" >> validation-report.md
          echo "- Status: âœ… Completed" >> validation-report.md
          
          echo "âœ… Report generated"
          cat validation-report.md

      - name: ğŸ“¤ Upload Report
        uses: actions/upload-artifact@v4
        if: always()
        with:
          name: simple-validation-report-${{ github.run_number }}
          path: validation-report.md
          retention-days: 7

      - name: ğŸ“‹ Summary
        run: |
          echo "ğŸ‰ Simple template validation completed!"
          echo "Check the artifacts for the detailed report."
